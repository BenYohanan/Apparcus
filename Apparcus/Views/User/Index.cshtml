@model Core.ViewModels.UserDashboardDto
@{
    ViewData["Title"] = "Dashboard";
    Layout = ViewBag.Layout;
}

<div class="page-wrapper">
    <div class="content">
        <!-- Breadcrumb -->
        <div class="d-md-flex d-block align-items-center justify-content-between page-breadcrumb mb-3">
            <div class="my-auto mb-2">
                <h2 class="mb-1">Welcome back, @Model.FullName</h2>
                <nav>
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item">
                            <a asp-action="Index"><i class="ti ti-smart-home"></i></a>
                        </li>
                        <li class="breadcrumb-item">Dashboard</li>
                        <li class="breadcrumb-item active">My Dashboard</li>
                    </ol>
                </nav>
            </div>
        </div>
        <!-- /Breadcrumb -->
        <!-- Welcome Alert -->
        <div class="alert bg-success-transparent alert-dismissible fade show mb-4">
            <i class="ti ti-confetti me-2"></i>
            Great to see you again! You have created <strong>@Model.ProjectCount</strong> project(s) amazing causes with a total of
            <strong>₦@Model.TotalEarnings</strong>.
            <button type="button" class="btn-close fs-14" data-bs-dismiss="alert"><i class="ti ti-x"></i></button>
        </div>

        <div class="row">
            <!-- User Profile Card -->
            <div class="col-xl-4 d-flex">
                <div class="card position-relative flex-fill">
                    <div class="card-header bg-dark">
                        <div class="d-flex align-items-center">
                            <span class="avatar avatar-lg avatar-rounded border border-white border-2 flex-shrink-0 me-2">
                                <img src="/Template/assets/img/users/user-01.jpg" alt="@Model.FullName">
                            </span>
                            <div>
                                <h5 class="text-white mb-1">@Model.FullName</h5>
                                <div class="d-flex align-items-center">
                                    <p class="text-white fs-12 mb-0">Project Creator & Supporter</p>
                                    <span class="mx-1"><i class="ti ti-point-filled text-primary"></i></span>
                                    <p class="fs-12">Active Member</p>
                                </div>
                            </div>
                        </div>
                        <a asp-controller="Account" asp-action="Profile" class="btn btn-icon btn-sm text-white rounded-circle edit-top">
                            <i class="ti ti-edit"></i>
                        </a>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <span class="d-block mb-1 fs-13">Phone Number</span>
                            <p class="text-gray-9">@(string.IsNullOrEmpty(Model.PhoneNumber) ? "" : Model.PhoneNumber)</p>
                        </div>
                        <div class="mb-3">
                            <span class="d-block mb-1 fs-13">Email Address</span>
                            <p class="text-gray-9">@Model.Email</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Project & Support Stats (Middle Card) -->
            <div class="col-xl-5 d-flex">
                <div class="card flex-fill">
                    <div class="card-header">
                        <div class="d-flex align-items-center justify-content-between">
                            <h5>Activity Overview</h5>
                            <span class="badge bg-primary">This Year</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row align-items-center text-center text-md-start">
                            <div class="col-md-6">
                                <div class="mb-4">
                                    <p class="d-flex align-items-center justify-content-center justify-content-md-start">
                                        <i class="ti ti-circle-filled fs-10 text-primary me-2"></i>
                                        <span class="text-gray-9">@Model.ProjectCount</span>
                                        <span class="ms-2 text-muted">Projects Created</span>
                                    </p>
                                </div>
                                <div class="mb-4">
                                    <p class="d-flex align-items-center justify-content-center justify-content-md-start">
                                        <i class="ti ti-circle-filled fs-10 text-success me-2"></i>
                                        <span class="text-gray-9">@Model.ContibutorsCount</span>
                                        <span class="ms-2 text-muted">Projects Supported</span>
                                    </p>
                                </div>
                                <div class="mb-4">
                                    <p class="d-flex align-items-center justify-content-center justify-content-md-start">
                                        <i class="ti ti-circle-filled fs-10 text-warning me-2"></i>
                                        <span class="text-gray-9">@Model.TotalEarnings</span>
                                        <span class="ms-2 text-muted">Total Contributed</span>
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div id="activity_chart" class="mx-auto mx-md-0"></div>
                            </div>
                            <div class="col-12 mt-3">
                                <div class="alert alert-light border-0 mb-0 py-2">
                                    <i class="ti ti-trophy text-warning me-2"></i>
                                    You're in the top <strong>15%</strong> of active supporters this month!
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats Summary -->
            <div class="col-xl-3 d-flex">
                <div class="card flex-fill">
                    <div class="card-header">
                        <h5>Quick Summary</h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-12 mb-4">
                                <div class="bg-light-primary rounded-3 p-3">
									<h4 class="text-primary mb-1">@Model.ProjectCount</h4>
                                    <small class="text-muted">Active Projects</small>
                                </div>
                            </div>
                            <div class="col-12 mb-4">
                                <div class="bg-light-success rounded-3 p-3">
									<h4 class="text-success mb-1">@Model.ContibutorsCount</h4>
                                    <small class="text-muted">Supported</small>
                                </div>
                            </div>
                            <div class="col-12 mb-4">
                                <div class="bg-light-warning rounded-3 p-3">
									<h4 class="text-warning mb-1">₦@Model.TotalEarnings</h4>
                                    <small class="text-muted">Total Given</small>
                                </div>
                            </div>
                            <div class="col-12">
                                <a href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#add_project" class="btn btn-primary 
                                    d-flex align-items-center"><i class="ti ti-circle-plus me-2"></i>Create Project
                                 </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
					<div class="col-xl-5 d-flex">
						<div class="card flex-fill">
							<div class="card-header">
								<div class="d-flex align-items-center justify-content-between flex-wrap row-gap-2">
									<h5>Performance</h5>
									<div class="dropdown">
										<a href="javascript:void(0);" class="btn btn-white border btn-sm d-inline-flex align-items-center" data-bs-toggle="dropdown">
											<i class="ti ti-calendar me-1"></i>2024
										</a>
										<ul class="dropdown-menu  dropdown-menu-end p-3">
											<li>
												<a href="javascript:void(0);" class="dropdown-item rounded-1">2024</a>
											</li>
											<li>
												<a href="javascript:void(0);" class="dropdown-item rounded-1">2023</a>
											</li>
											<li>
												<a href="javascript:void(0);" class="dropdown-item rounded-1">2022</a>
											</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="card-body">
								<div>
									<div class="bg-light d-flex align-items-center rounded p-2">
										<h3 class="me-2">98%</h3>
										<span class="badge badge-outline-success bg-success-transparent rounded-pill me-1">12%</span>
										<span>vs last years</span>
									</div>
									<div id="performance_chart2"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-4 d-flex">
						<div class="card flex-fill">
							<div class="card-header">
								<div class="d-flex align-items-center justify-content-between flex-wrap row-gap-2">
									<h5>My Skills</h5>
									<div class="dropdown">
										<a href="javascript:void(0);" class="btn btn-white border btn-sm d-inline-flex align-items-center" data-bs-toggle="dropdown">
											<i class="ti ti-calendar me-1"></i>2024
										</a>
										<ul class="dropdown-menu  dropdown-menu-end p-3">
											<li>
												<a href="javascript:void(0);" class="dropdown-item rounded-1">2024</a>
											</li>
											<li>
												<a href="javascript:void(0);" class="dropdown-item rounded-1">2023</a>
											</li>
											<li>
												<a href="javascript:void(0);" class="dropdown-item rounded-1">2022</a>
											</li>
										</ul>
									</div>
								</div>
							</div>
							<div class="card-body">
								<div>
									<div class="border border-dashed bg-transparent-light rounded p-2 mb-2">
										<div class="d-flex align-items-center justify-content-between">
											<div class="d-flex align-items-center">
												<span class="d-block border border-2 h-12 border-primary rounded-5 me-2"></span>
												<div>
													<h6 class="fw-medium mb-1">Figma</h6>
													<p>Updated : 15 May 2025</p>
												</div>
											</div>
											<div class="circle-progress circle-progress-md"  data-value='95'>
												<span class="progress-left">
													<span class="progress-bar border-primary"></span>
												</span>
												<span class="progress-right">
													<span class="progress-bar border-primary"></span>
												</span>
												<div class="progress-value">95%</div>
											</div>
										</div>
									</div>
									<div class="border border-dashed bg-transparent-light rounded p-2 mb-2">
										<div class="d-flex align-items-center justify-content-between">
											<div class="d-flex align-items-center">
												<span class="d-block border border-2 h-12 border-success rounded-5 me-2"></span>
												<div>
													<h6 class="fw-medium mb-1">HTML</h6>
													<p>Updated : 12 May 2025</p>
												</div>
											</div>
											<div class="circle-progress circle-progress-md"  data-value='85'>
												<span class="progress-left">
													<span class="progress-bar border-success"></span>
												</span>
												<span class="progress-right">
													<span class="progress-bar border-success"></span>
												</span>
												<div class="progress-value">85%</div>
											</div>
										</div>
									</div>
									<div class="border border-dashed bg-transparent-light rounded p-2 mb-2">
										<div class="d-flex align-items-center justify-content-between">
											<div class="d-flex align-items-center">
												<span class="d-block border border-2 h-12 border-purple rounded-5 me-2"></span>
												<div>
													<h6 class="fw-medium mb-1">CSS</h6>
													<p>Updated : 12 May 2025</p>
												</div>
											</div>
											<div class="circle-progress circle-progress-md"  data-value='70'>
												<span class="progress-left">
													<span class="progress-bar border-purple"></span>
												</span>
												<span class="progress-right">
													<span class="progress-bar border-purple"></span>
												</span>
												<div class="progress-value">70%</div>
											</div>
										</div>
									</div>
									<div class="border border-dashed bg-transparent-light rounded p-2 mb-2">
										<div class="d-flex align-items-center justify-content-between">
											<div class="d-flex align-items-center">
												<span class="d-block border border-2 h-12 border-info rounded-5 me-2"></span>
												<div>
													<h6 class="fw-medium mb-1">Wordpress</h6>
													<p>Updated : 15 May 2025</p>
												</div>
											</div>
											<div class="circle-progress circle-progress-md"  data-value='61'>
												<span class="progress-left">
													<span class="progress-bar border-info"></span>
												</span>
												<span class="progress-right">
													<span class="progress-bar border-info"></span>
												</span>
												<div class="progress-value">61%</div>
											</div>
										</div>
									</div>
									<div class="border border-dashed bg-transparent-light rounded p-2">
										<div class="d-flex align-items-center justify-content-between">
											<div class="d-flex align-items-center">
												<span class="d-block border border-2 h-12 border-dark rounded-5 me-2"></span>
												<div>
													<h6 class="fw-medium mb-1">Javascript</h6>
													<p>Updated : 13 May 2025</p>
												</div>
											</div>
											<div class="circle-progress circle-progress-md"  data-value='58'>
												<span class="progress-left">
													<span class="progress-bar border-dark"></span>
												</span>
												<span class="progress-right">
													<span class="progress-bar border-dark"></span>
												</span>
												<div class="progress-value">58%</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-3 d-flex">
						<div class="flex-fill">
							<div class="card card-bg-5 bg-dark mb-3">
								<div class="card-body">
									<div class="text-center">
										<h5 class="text-white mb-4">Team Birthday</h5>
										<span class="avatar avatar-xl avatar-rounded mb-2">
											<img src="assets/img/users/user-35.jpg" alt="Img">
										</span>
										<div class="mb-3">
											<h6 class="text-white fw-medium mb-1">Andrew Jermia</h6>
											<p>IOS Developer</p>
										</div>
										<a href="#" class="btn btn-sm btn-primary">Send Wishes</a>
									</div>
								</div>
							</div>
							<div class="card bg-secondary mb-3">
								<div class="card-body d-flex align-items-center justify-content-between p-3">
									<div>
										<h5 class="text-white mb-1">Leave Policy</h5>
										<p class="text-white">Last Updated : Today</p>
									</div>
									<a href="#" class="btn btn-white btn-sm px-3">View All</a>
								</div>
							</div>
							<div class="card bg-warning">
								<div class="card-body d-flex align-items-center justify-content-between p-3">
									<div>
										<h5 class="mb-1">Next Holiday</h5>
										<p class="text-gray-9">Diwali, 15 Sep 2025</p>
									</div>
									<a href="holidays.html" class="btn btn-white btn-sm px-3">View All</a>
								</div>
							</div>
						</div>
					</div>
				</div>

    </div>
</div>

<!-- Add Project Modal -->
<div class="modal fade" id="add_project" role="dialog">
    <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Project</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-control" id="name">
                </div>
                <div class="mb-3">
                    <label class="form-label">Description</label>
                    <textarea id="description" class="form-control summernote"></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Amount Needed</label>
                    <input type="number" class="form-control" id="amountNeeded">
                </div>
            </div>
            <div class="modal-footer">
                <div class="d-flex align-items-center justify-content-end">
                    <button type="button" class="btn btn-outline-light border me-2" data-bs-dismiss="modal">Cancel</button>
                    <button class="btn btn-primary" onclick="saveProject()" type="button" data-bs-toggle="modal">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/template/assets/plugins/apexchart/apexcharts.min.js"></script>
@section Scripts {
    <script src="~/template/assets/plugins/apexchart/apexcharts.min.js"></script>
    <script>
        // Simple donut chart for activity
        var options = {
            series: [@ViewBag.TotalProjects, @ViewBag.TotalSupported, (int)ViewBag.TotalRaised / 1000],
            chart: { type: 'donut', height: 220 },
            colors: ['#4361ee', '#2ecc71', '#f39c12'],
            labels: ['My Projects', 'Supported', 'Given (x1000)'],
            legend: { position: 'bottom' },
            dataLabels: { enabled: false },
            responsive: [{
                breakpoint: 480,
                options: { chart: { width: 200 }, legend: { position: 'bottom' }}
            }]
        };
        var chart = new ApexCharts(document.querySelector("#activity_chart"), options);
        chart.render();
    </script>
}
